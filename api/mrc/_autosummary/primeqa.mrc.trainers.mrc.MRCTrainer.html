
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>primeqa.mrc.trainers.mrc.MRCTrainer &#8212; PrimeQA  documentation</title>
<link rel="stylesheet" href="../../../_static/plex.css" type="text/css">

<script>
  document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
  document.documentElement.dataset.theme = localStorage.getItem("theme") || "light"
</script>

  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=92025949c220c2e29695" rel="stylesheet">
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=92025949c220c2e29695" rel="stylesheet">


  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    <link rel="icon" sizes="16x16" type="image/png" href="../../../_static/primeqa_logo.png" />
    <link rel="icon" sizes="32x32" type="image/png" href="../../../_static/primeqa_logo.png" />
    <link rel="apple-touch-icon" sizes="180x180" type="image/png" href="../../../_static/primeqa_logo.png" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" />

  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/design-tabs.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
<script async
    src="https://api.countapi.xyz/hit/mnlp-qa-dev-2.sl.cloud9.ibm.com/visits?callback=callbackCounter"></script>
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="light">
    <div class="bd-header-announcement container-fluid" id="banner">
      

    </div>

    
    <nav class="bd-header navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="bd-header__inner container-xl">

  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
    <p class="title logo__title">PrimeQA: The Prime Repository for QA</p>
  
</a>
    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="fas fa-bars"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../installation.html">
  Installation
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../development.html">
  Development
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../testing.html">
  Testing
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../index.html">
  API
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/primeqa/primeqa/" rel="noopener" target="_blank" title="GitHub"><img src="https://badgen.net/github/stars/primeqa/primeqa?icon=github" class="icon-link-image" alt="GitHub"/></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://join.slack.com/t/primeqaworkspace/shared_invite/zt-1edc4fn7n-6aUO0CCvDOMOLb0drROwSw" rel="noopener" target="_blank" title="Slack"><img src="https://cdn.bfldr.com/5H442O3W/at/pl546j-7le8zk-6gwiyo/Slack_Mark.svg?auto=webp&format=png" class="icon-link-image" alt="Slack"/></a>
        </li>
      </ul>
      </div>
      
      <div class="navbar-end-item">
        <span id="theme-switch" class="btn btn-sm btn-outline-primary navbar-btn rounded-circle">
    <a class="theme-switch" data-mode="light"><i class="fas fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="far fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fas fa-adjust"></i></a>
</span>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="bd-container container-xl">
      <div class="bd-container__inner row">
          

<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="bd-sidebar-primary col-12 col-md-3 bd-sidebar">
  <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="primeqa.mrc.data_models.html">
   data_models
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="primeqa.mrc.data_models.eval_prediction_with_processing.html">
     eval_prediction_with_processing
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="primeqa.mrc.data_models.eval_prediction_with_processing.EvalPredictionWithProcessing.html">
       primeqa.mrc.data_models.eval_prediction_with_processing.EvalPredictionWithProcessing
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="primeqa.mrc.data_models.model_outputs.html">
     model_outputs
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="primeqa.mrc.data_models.model_outputs.extractive.html">
       extractive
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
      <label for="toctree-checkbox-4">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.data_models.model_outputs.extractive.ExtractiveQAModelOutput.html">
         primeqa.mrc.data_models.model_outputs.extractive.ExtractiveQAModelOutput
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.data_models.model_outputs.extractive.ExtractiveQAWithConfidenceModelOutput.html">
         primeqa.mrc.data_models.model_outputs.extractive.ExtractiveQAWithConfidenceModelOutput
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="primeqa.mrc.data_models.subsample_type.html">
     subsample_type
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="primeqa.mrc.data_models.subsample_type.SubsampleType.html">
       primeqa.mrc.data_models.subsample_type.SubsampleType
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="primeqa.mrc.data_models.target_type.html">
     target_type
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="primeqa.mrc.data_models.target_type.TargetType.html">
       primeqa.mrc.data_models.target_type.TargetType
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="primeqa.mrc.metrics.html">
   metrics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="primeqa.mrc.metrics.mlqa.html">
     mlqa
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
    <label for="toctree-checkbox-8">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="primeqa.mrc.metrics.mlqa.mlqa.html">
       mlqa
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
      <label for="toctree-checkbox-9">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.mlqa.mlqa.MLQA.html">
         primeqa.mrc.metrics.mlqa.mlqa.MLQA
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="primeqa.mrc.metrics.mlqa.mlqa_evaluation_v1.html">
       mlqa_evaluation_v1
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
      <label for="toctree-checkbox-10">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.mlqa.mlqa_evaluation_v1.evaluate.html">
         primeqa.mrc.metrics.mlqa.mlqa_evaluation_v1.evaluate
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.mlqa.mlqa_evaluation_v1.exact_match_score.html">
         primeqa.mrc.metrics.mlqa.mlqa_evaluation_v1.exact_match_score
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.mlqa.mlqa_evaluation_v1.f1_score.html">
         primeqa.mrc.metrics.mlqa.mlqa_evaluation_v1.f1_score
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.mlqa.mlqa_evaluation_v1.metric_max_over_ground_truths.html">
         primeqa.mrc.metrics.mlqa.mlqa_evaluation_v1.metric_max_over_ground_truths
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.mlqa.mlqa_evaluation_v1.mixed_segmentation.html">
         primeqa.mrc.metrics.mlqa.mlqa_evaluation_v1.mixed_segmentation
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.mlqa.mlqa_evaluation_v1.normalize_answer.html">
         primeqa.mrc.metrics.mlqa.mlqa_evaluation_v1.normalize_answer
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.mlqa.mlqa_evaluation_v1.whitespace_tokenize.html">
         primeqa.mrc.metrics.mlqa.mlqa_evaluation_v1.whitespace_tokenize
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="primeqa.mrc.metrics.nq_f1.html">
     nq_f1
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
    <label for="toctree-checkbox-11">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="primeqa.mrc.metrics.nq_f1.eval_utils.html">
       eval_utils
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
      <label for="toctree-checkbox-12">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.nq_f1.eval_utils.gold_has_long_answer.html">
         primeqa.mrc.metrics.nq_f1.eval_utils.gold_has_long_answer
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.nq_f1.eval_utils.gold_has_short_answer.html">
         primeqa.mrc.metrics.nq_f1.eval_utils.gold_has_short_answer
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.nq_f1.eval_utils.is_null_span_list.html">
         primeqa.mrc.metrics.nq_f1.eval_utils.is_null_span_list
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.nq_f1.eval_utils.nonnull_span_equal.html">
         primeqa.mrc.metrics.nq_f1.eval_utils.nonnull_span_equal
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.nq_f1.eval_utils.parse_json_as_predictions.html">
         primeqa.mrc.metrics.nq_f1.eval_utils.parse_json_as_predictions
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.nq_f1.eval_utils.parse_json_as_topk_predictions.html">
         primeqa.mrc.metrics.nq_f1.eval_utils.parse_json_as_topk_predictions
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.nq_f1.eval_utils.read_annotation.html">
         primeqa.mrc.metrics.nq_f1.eval_utils.read_annotation
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.nq_f1.eval_utils.read_annotation_from_one_split.html">
         primeqa.mrc.metrics.nq_f1.eval_utils.read_annotation_from_one_split
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.nq_f1.eval_utils.read_prediction_json_from_file.html">
         primeqa.mrc.metrics.nq_f1.eval_utils.read_prediction_json_from_file
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.nq_f1.eval_utils.span_set_equal.html">
         primeqa.mrc.metrics.nq_f1.eval_utils.span_set_equal
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.nq_f1.eval_utils.NQLabel.html">
         primeqa.mrc.metrics.nq_f1.eval_utils.NQLabel
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.nq_f1.eval_utils.NQSpan.html">
         primeqa.mrc.metrics.nq_f1.eval_utils.NQSpan
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.nq_f1.eval_utils.InconsistentSpanError.html">
         primeqa.mrc.metrics.nq_f1.eval_utils.InconsistentSpanError
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="primeqa.mrc.metrics.nq_f1.nq_eval.html">
       nq_eval
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
      <label for="toctree-checkbox-13">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.nq_f1.nq_eval.compute_f1.html">
         primeqa.mrc.metrics.nq_f1.nq_eval.compute_f1
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.nq_f1.nq_eval.compute_final_f1.html">
         primeqa.mrc.metrics.nq_f1.nq_eval.compute_final_f1
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.nq_f1.nq_eval.compute_optimal_metrics.html">
         primeqa.mrc.metrics.nq_f1.nq_eval.compute_optimal_metrics
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.nq_f1.nq_eval.compute_pr_curves.html">
         primeqa.mrc.metrics.nq_f1.nq_eval.compute_pr_curves
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.nq_f1.nq_eval.extract_metrics_at_optimal_threshold.html">
         primeqa.mrc.metrics.nq_f1.nq_eval.extract_metrics_at_optimal_threshold
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.nq_f1.nq_eval.get_metrics_as_dict.html">
         primeqa.mrc.metrics.nq_f1.nq_eval.get_metrics_as_dict
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.nq_f1.nq_eval.get_metrics_with_answer_stats.html">
         primeqa.mrc.metrics.nq_f1.nq_eval.get_metrics_with_answer_stats
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.nq_f1.nq_eval.load_gt_lookup_as_dict.html">
         primeqa.mrc.metrics.nq_f1.nq_eval.load_gt_lookup_as_dict
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.nq_f1.nq_eval.pretty_print.html">
         primeqa.mrc.metrics.nq_f1.nq_eval.pretty_print
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.nq_f1.nq_eval.print_r_at_p_table.html">
         primeqa.mrc.metrics.nq_f1.nq_eval.print_r_at_p_table
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.nq_f1.nq_eval.safe_divide.html">
         primeqa.mrc.metrics.nq_f1.nq_eval.safe_divide
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.nq_f1.nq_eval.score_answers.html">
         primeqa.mrc.metrics.nq_f1.nq_eval.score_answers
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.nq_f1.nq_eval.score_long_answer.html">
         primeqa.mrc.metrics.nq_f1.nq_eval.score_long_answer
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.nq_f1.nq_eval.score_short_answer.html">
         primeqa.mrc.metrics.nq_f1.nq_eval.score_short_answer
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="primeqa.mrc.metrics.nq_f1.nq_f1.html">
       nq_f1
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
      <label for="toctree-checkbox-14">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.nq_f1.nq_f1.NQF1.html">
         primeqa.mrc.metrics.nq_f1.nq_f1.NQF1
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="primeqa.mrc.metrics.squad.html">
     squad
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
    <label for="toctree-checkbox-15">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="primeqa.mrc.metrics.squad.evaluate.html">
       evaluate
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
      <label for="toctree-checkbox-16">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.squad.evaluate.evaluate.html">
         primeqa.mrc.metrics.squad.evaluate.evaluate
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.squad.evaluate.exact_match_score.html">
         primeqa.mrc.metrics.squad.evaluate.exact_match_score
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.squad.evaluate.f1_score.html">
         primeqa.mrc.metrics.squad.evaluate.f1_score
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.squad.evaluate.metric_max_over_ground_truths.html">
         primeqa.mrc.metrics.squad.evaluate.metric_max_over_ground_truths
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.squad.evaluate.normalize_answer.html">
         primeqa.mrc.metrics.squad.evaluate.normalize_answer
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="primeqa.mrc.metrics.squad.squad.html">
       squad
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
      <label for="toctree-checkbox-17">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.squad.squad.SQUAD.html">
         primeqa.mrc.metrics.squad.squad.SQUAD
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="primeqa.mrc.metrics.tydi_f1.html">
     tydi_f1
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
    <label for="toctree-checkbox-18">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="primeqa.mrc.metrics.tydi_f1.eval_utils.html">
       eval_utils
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
      <label for="toctree-checkbox-19">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.tydi_f1.eval_utils.compute_partial_match_scores.html">
         primeqa.mrc.metrics.tydi_f1.eval_utils.compute_partial_match_scores
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.tydi_f1.eval_utils.gold_has_minimal_answer.html">
         primeqa.mrc.metrics.tydi_f1.eval_utils.gold_has_minimal_answer
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.tydi_f1.eval_utils.gold_has_passage_answer.html">
         primeqa.mrc.metrics.tydi_f1.eval_utils.gold_has_passage_answer
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.tydi_f1.eval_utils.nonnull_span_equal.html">
         primeqa.mrc.metrics.tydi_f1.eval_utils.nonnull_span_equal
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.tydi_f1.eval_utils.safe_average.html">
         primeqa.mrc.metrics.tydi_f1.eval_utils.safe_average
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.tydi_f1.eval_utils.safe_divide.html">
         primeqa.mrc.metrics.tydi_f1.eval_utils.safe_divide
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.tydi_f1.eval_utils.Span.html">
         primeqa.mrc.metrics.tydi_f1.eval_utils.Span
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.tydi_f1.eval_utils.TyDiLabel.html">
         primeqa.mrc.metrics.tydi_f1.eval_utils.TyDiLabel
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="primeqa.mrc.metrics.tydi_f1.tydi_eval.html">
       tydi_eval
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
      <label for="toctree-checkbox-20">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.tydi_f1.tydi_eval.byte_slice.html">
         primeqa.mrc.metrics.tydi_f1.tydi_eval.byte_slice
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.tydi_f1.tydi_eval.compute_final_f1.html">
         primeqa.mrc.metrics.tydi_f1.tydi_eval.compute_final_f1
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.tydi_f1.tydi_eval.compute_macro_f1.html">
         primeqa.mrc.metrics.tydi_f1.tydi_eval.compute_macro_f1
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.tydi_f1.tydi_eval.compute_pr_curves.html">
         primeqa.mrc.metrics.tydi_f1.tydi_eval.compute_pr_curves
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.tydi_f1.tydi_eval.get_latex_str.html">
         primeqa.mrc.metrics.tydi_f1.tydi_eval.get_latex_str
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.tydi_f1.tydi_eval.get_metrics_with_answer_stats.html">
         primeqa.mrc.metrics.tydi_f1.tydi_eval.get_metrics_with_answer_stats
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.tydi_f1.tydi_eval.pretty_print.html">
         primeqa.mrc.metrics.tydi_f1.tydi_eval.pretty_print
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.tydi_f1.tydi_eval.print_r_at_p_table.html">
         primeqa.mrc.metrics.tydi_f1.tydi_eval.print_r_at_p_table
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.tydi_f1.tydi_eval.score_answers.html">
         primeqa.mrc.metrics.tydi_f1.tydi_eval.score_answers
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.tydi_f1.tydi_eval.score_minimal_answer.html">
         primeqa.mrc.metrics.tydi_f1.tydi_eval.score_minimal_answer
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.tydi_f1.tydi_eval.score_passage_answer.html">
         primeqa.mrc.metrics.tydi_f1.tydi_eval.score_passage_answer
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="primeqa.mrc.metrics.tydi_f1.tydi_f1.html">
       tydi_f1
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/>
      <label for="toctree-checkbox-21">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.metrics.tydi_f1.tydi_f1.TyDiF1.html">
         primeqa.mrc.metrics.tydi_f1.tydi_f1.TyDiF1
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="primeqa.mrc.models.html">
   models
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/>
  <label for="toctree-checkbox-22">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="primeqa.mrc.models.heads.html">
     heads
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/>
    <label for="toctree-checkbox-23">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="primeqa.mrc.models.heads.abstract.html">
       abstract
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/>
      <label for="toctree-checkbox-24">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.models.heads.abstract.AbstractTaskHead.html">
         primeqa.mrc.models.heads.abstract.AbstractTaskHead
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="primeqa.mrc.models.heads.extractive.html">
       extractive
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/>
      <label for="toctree-checkbox-25">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.models.heads.extractive.ExtractiveQAHead.html">
         primeqa.mrc.models.heads.extractive.ExtractiveQAHead
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.models.heads.extractive.ExtractiveQAWithConfidenceHead.html">
         primeqa.mrc.models.heads.extractive.ExtractiveQAWithConfidenceHead
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="primeqa.mrc.models.task_model.html">
     task_model
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" type="checkbox"/>
    <label for="toctree-checkbox-26">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="primeqa.mrc.models.task_model.ModelForDownstreamTasks.html">
       primeqa.mrc.models.task_model.ModelForDownstreamTasks
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="primeqa.mrc.processors.html">
   processors
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" type="checkbox"/>
  <label for="toctree-checkbox-27">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="primeqa.mrc.processors.postprocessors.html">
     postprocessors
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" type="checkbox"/>
    <label for="toctree-checkbox-28">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="primeqa.mrc.processors.postprocessors.abstract.html">
       abstract
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" type="checkbox"/>
      <label for="toctree-checkbox-29">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.processors.postprocessors.abstract.AbstractPostProcessor.html">
         primeqa.mrc.processors.postprocessors.abstract.AbstractPostProcessor
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="primeqa.mrc.processors.postprocessors.extractive.html">
       extractive
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" type="checkbox"/>
      <label for="toctree-checkbox-30">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.processors.postprocessors.extractive.ExtractivePostProcessor.html">
         primeqa.mrc.processors.postprocessors.extractive.ExtractivePostProcessor
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="primeqa.mrc.processors.postprocessors.natural_questions.html">
       natural_questions
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" type="checkbox"/>
      <label for="toctree-checkbox-31">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.processors.postprocessors.natural_questions.NaturalQuestionsPostProcessor.html">
         primeqa.mrc.processors.postprocessors.natural_questions.NaturalQuestionsPostProcessor
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="primeqa.mrc.processors.postprocessors.scorers.html">
       scorers
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" type="checkbox"/>
      <label for="toctree-checkbox-32">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.processors.postprocessors.scorers.compute_score_diff_between_span_and_cls.html">
         primeqa.mrc.processors.postprocessors.scorers.compute_score_diff_between_span_and_cls
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.processors.postprocessors.scorers.compute_short_answer_type_weighted_score_diff_between_span_and_cls.html">
         primeqa.mrc.processors.postprocessors.scorers.compute_short_answer_type_weighted_score_diff_between_span_and_cls
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.processors.postprocessors.scorers.compute_weighted_sum_short_answer_type_score_diff_between_span_and_cls.html">
         primeqa.mrc.processors.postprocessors.scorers.compute_weighted_sum_short_answer_type_score_diff_between_span_and_cls
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.processors.postprocessors.scorers.initialize_scorer.html">
         primeqa.mrc.processors.postprocessors.scorers.initialize_scorer
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.processors.postprocessors.scorers.SupportedSpanScorers.html">
         primeqa.mrc.processors.postprocessors.scorers.SupportedSpanScorers
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="primeqa.mrc.processors.postprocessors.squad.html">
       squad
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-33" name="toctree-checkbox-33" type="checkbox"/>
      <label for="toctree-checkbox-33">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.processors.postprocessors.squad.SQUADPostProcessor.html">
         primeqa.mrc.processors.postprocessors.squad.SQUADPostProcessor
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="primeqa.mrc.processors.preprocessors.html">
     preprocessors
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-34" name="toctree-checkbox-34" type="checkbox"/>
    <label for="toctree-checkbox-34">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="primeqa.mrc.processors.preprocessors.abstract.html">
       abstract
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-35" name="toctree-checkbox-35" type="checkbox"/>
      <label for="toctree-checkbox-35">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.processors.preprocessors.abstract.AbstractPreProcessor.html">
         primeqa.mrc.processors.preprocessors.abstract.AbstractPreProcessor
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="primeqa.mrc.processors.preprocessors.base.html">
       base
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-36" name="toctree-checkbox-36" type="checkbox"/>
      <label for="toctree-checkbox-36">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.processors.preprocessors.base.BasePreProcessor.html">
         primeqa.mrc.processors.preprocessors.base.BasePreProcessor
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="primeqa.mrc.processors.preprocessors.mrqa.html">
       mrqa
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-37" name="toctree-checkbox-37" type="checkbox"/>
      <label for="toctree-checkbox-37">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.processors.preprocessors.mrqa.MRQAPreprocessor.html">
         primeqa.mrc.processors.preprocessors.mrqa.MRQAPreprocessor
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="primeqa.mrc.processors.preprocessors.natural_questions.html">
       natural_questions
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-38" name="toctree-checkbox-38" type="checkbox"/>
      <label for="toctree-checkbox-38">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.processors.preprocessors.natural_questions.NaturalQuestionsPreProcessor.html">
         primeqa.mrc.processors.preprocessors.natural_questions.NaturalQuestionsPreProcessor
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="primeqa.mrc.processors.preprocessors.squad.html">
       squad
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-39" name="toctree-checkbox-39" type="checkbox"/>
      <label for="toctree-checkbox-39">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.processors.preprocessors.squad.SQUADPreprocessor.html">
         primeqa.mrc.processors.preprocessors.squad.SQUADPreprocessor
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="primeqa.mrc.processors.preprocessors.tydiboolqa_bpes.html">
       tydiboolqa_bpes
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-40" name="toctree-checkbox-40" type="checkbox"/>
      <label for="toctree-checkbox-40">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.processors.preprocessors.tydiboolqa_bpes.TyDiBoolQAPreprocessor.html">
         primeqa.mrc.processors.preprocessors.tydiboolqa_bpes.TyDiBoolQAPreprocessor
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="primeqa.mrc.processors.preprocessors.tydiqa.html">
       tydiqa
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-41" name="toctree-checkbox-41" type="checkbox"/>
      <label for="toctree-checkbox-41">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.processors.preprocessors.tydiqa.TyDiQAPreprocessor.html">
         primeqa.mrc.processors.preprocessors.tydiqa.TyDiQAPreprocessor
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="primeqa.mrc.processors.preprocessors.tydiqa_google.html">
       tydiqa_google
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-42" name="toctree-checkbox-42" type="checkbox"/>
      <label for="toctree-checkbox-42">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="primeqa.mrc.processors.preprocessors.tydiqa_google.TyDiQAGooglePreprocessor.html">
         primeqa.mrc.processors.preprocessors.tydiqa_google.TyDiQAGooglePreprocessor
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="primeqa.mrc.trainers.html">
   trainers
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-43" name="toctree-checkbox-43" type="checkbox"/>
  <label for="toctree-checkbox-43">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active has-children">
    <a class="reference internal" href="primeqa.mrc.trainers.mrc.html">
     mrc
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-44" name="toctree-checkbox-44" type="checkbox"/>
    <label for="toctree-checkbox-44">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="current">
     <li class="toctree-l3 current active">
      <a class="current reference internal" href="#">
       primeqa.mrc.trainers.mrc.MRCTrainer
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

  </div>
</nav>
  </div>
  <div class="sidebar-end-items">
  </div>
</div>


          


<div class="bd-sidebar-secondary d-none d-xl-block col-xl-2 bd-toc">
  
    
    <div class="toc-item">
      <div class="custom-right-section" style="padding: 2rem 0 0 0">
        <button onclick="window.open('https://github.com/primeqa/primeqa/discussions','_blank')" class="bootstrap-btn">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512" style="width: 1em; height: 1em;">
                        <!-- Font Awesome Pro 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) -->
                        <path style="fill: #459db9"
                                d="M96 224c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm448 0c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm32 32h-64c-17.6 0-33.5 7.1-45.1 18.6 40.3 22.1 68.9 62 75.1 109.4h66c17.7 0 32-14.3 32-32v-32c0-35.3-28.7-64-64-64zm-256 0c61.9 0 112-50.1 112-112S381.9 32 320 32 208 82.1 208 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C179.6 288 128 339.6 128 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zm-223.7-13.4C161.5 263.1 145.6 256 128 256H64c-35.3 0-64 28.7-64 64v32c0 17.7 14.3 32 32 32h65.9c6.3-47.4 34.9-87.3 75.2-109.4z" />
                </svg>&nbsp;Start a Discussion!</button>
        <button onclick="showSource()" class="bootstrap-btn"><svg xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 640 512" style="width: 1em; height: 1em;">
                        <!--! Font Awesome Pro 6.1.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. -->
                        <path style="fill: #459db9"
                                d="M414.8 40.79L286.8 488.8C281.9 505.8 264.2 515.6 247.2 510.8C230.2 505.9 220.4 488.2 225.2 471.2L353.2 23.21C358.1 6.216 375.8-3.624 392.8 1.232C409.8 6.087 419.6 23.8 414.8 40.79H414.8zM518.6 121.4L630.6 233.4C643.1 245.9 643.1 266.1 630.6 278.6L518.6 390.6C506.1 403.1 485.9 403.1 473.4 390.6C460.9 378.1 460.9 357.9 473.4 345.4L562.7 256L473.4 166.6C460.9 154.1 460.9 133.9 473.4 121.4C485.9 108.9 506.1 108.9 518.6 121.4V121.4zM166.6 166.6L77.25 256L166.6 345.4C179.1 357.9 179.1 378.1 166.6 390.6C154.1 403.1 133.9 403.1 121.4 390.6L9.372 278.6C-3.124 266.1-3.124 245.9 9.372 233.4L121.4 121.4C133.9 108.9 154.1 108.9 166.6 121.4C179.1 133.9 179.1 154.1 166.6 166.6V166.6z" />
                </svg>&nbsp;Show Source</button>
        <!-- <p style="color: #459db9">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512" style="width: 1em; height: 1em;">
                        <path style="fill: #459db9"
                                d="M96 224c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm448 0c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm32 32h-64c-17.6 0-33.5 7.1-45.1 18.6 40.3 22.1 68.9 62 75.1 109.4h66c17.7 0 32-14.3 32-32v-32c0-35.3-28.7-64-64-64zm-256 0c61.9 0 112-50.1 112-112S381.9 32 320 32 208 82.1 208 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C179.6 288 128 339.6 128 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zm-223.7-13.4C161.5 263.1 145.6 256 128 256H64c-35.3 0-64 28.7-64 64v32c0 17.7 14.3 32 32 32h65.9c6.3-47.4 34.9-87.3 75.2-109.4z" />
                </svg>&nbsp;<span id="visits"></span>
        </p> -->
        <img src="_static/img/PrimeQA.png" alt="primeqa" width="100"
                style="display: block;margin-left: auto;margin-right: auto;" />
</div>

<script>
        function showSource() {
                window.open("../../../_sources/api/mrc/_autosummary/primeqa.mrc.trainers.mrc.MRCTrainer.rst.txt", '_blank');
        }

        function hRefGitHub() {
                window.open('', '_blank');
        }
        // function callbackCounter(response) {
        //         document.getElementById('visits').innerText = response.value;
        // }
</script>
    </div>
    
    <div class="toc-item">
      

<nav id="bd-toc-nav">
    
</nav>
    </div>
    
  
</div>


          
          
          <div class="bd-content col-12 col-md-9 col-xl-7">
              
              <article class="bd-article" role="main">
                
  <section id="primeqa-mrc-trainers-mrc-mrctrainer">
<h1>primeqa.mrc.trainers.mrc.MRCTrainer<a class="headerlink" href="#primeqa-mrc-trainers-mrc-mrctrainer" title="Permalink to this headline">#</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="primeqa.mrc.trainers.mrc.MRCTrainer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">primeqa.mrc.trainers.mrc.</span></span><span class="sig-name descname"><span class="pre">MRCTrainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_examples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_dataset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">post_process_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#primeqa.mrc.trainers.mrc.MRCTrainer" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">transformers.trainer.Trainer</span></code></p>
<p class="rubric">Methods</p>
<table class="longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#primeqa.mrc.trainers.mrc.MRCTrainer.add_callback" title="primeqa.mrc.trainers.mrc.MRCTrainer.add_callback"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_callback</span></code></a></p></td>
<td><p>Add a callback to the current list of [<cite>~transformer.TrainerCallback</cite>].</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#primeqa.mrc.trainers.mrc.MRCTrainer.autocast_smart_context_manager" title="primeqa.mrc.trainers.mrc.MRCTrainer.autocast_smart_context_manager"><code class="xref py py-obj docutils literal notranslate"><span class="pre">autocast_smart_context_manager</span></code></a></p></td>
<td><p>A helper wrapper that creates an appropriate context manager for <cite>autocast</cite> while feeding it the desired arguments, depending on the situation.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">call_model_init</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#primeqa.mrc.trainers.mrc.MRCTrainer.compute_loss" title="primeqa.mrc.trainers.mrc.MRCTrainer.compute_loss"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_loss</span></code></a></p></td>
<td><p>How the loss is computed by Trainer.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_model_card</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#primeqa.mrc.trainers.mrc.MRCTrainer.create_optimizer" title="primeqa.mrc.trainers.mrc.MRCTrainer.create_optimizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_optimizer</span></code></a></p></td>
<td><p>Setup the optimizer.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#primeqa.mrc.trainers.mrc.MRCTrainer.create_optimizer_and_scheduler" title="primeqa.mrc.trainers.mrc.MRCTrainer.create_optimizer_and_scheduler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_optimizer_and_scheduler</span></code></a></p></td>
<td><p>Setup the optimizer and the learning rate scheduler.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#primeqa.mrc.trainers.mrc.MRCTrainer.create_scheduler" title="primeqa.mrc.trainers.mrc.MRCTrainer.create_scheduler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_scheduler</span></code></a></p></td>
<td><p>Setup the scheduler.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#primeqa.mrc.trainers.mrc.MRCTrainer.evaluate" title="primeqa.mrc.trainers.mrc.MRCTrainer.evaluate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate</span></code></a></p></td>
<td><p>Evaluate model using either eval data passed to method (if given).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#primeqa.mrc.trainers.mrc.MRCTrainer.evaluation_loop" title="primeqa.mrc.trainers.mrc.MRCTrainer.evaluation_loop"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluation_loop</span></code></a></p></td>
<td><p>Prediction/evaluation loop, shared by <cite>Trainer.evaluate()</cite> and <cite>Trainer.predict()</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#primeqa.mrc.trainers.mrc.MRCTrainer.floating_point_ops" title="primeqa.mrc.trainers.mrc.MRCTrainer.floating_point_ops"><code class="xref py py-obj docutils literal notranslate"><span class="pre">floating_point_ops</span></code></a></p></td>
<td><p>For models that inherit from [<cite>PreTrainedModel</cite>], uses that method to compute the number of floating point operations for every backward + forward pass.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#primeqa.mrc.trainers.mrc.MRCTrainer.get_eval_dataloader" title="primeqa.mrc.trainers.mrc.MRCTrainer.get_eval_dataloader"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_eval_dataloader</span></code></a></p></td>
<td><p>Returns the evaluation torch <cite>DataLoader</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#primeqa.mrc.trainers.mrc.MRCTrainer.get_optimizer_cls_and_kwargs" title="primeqa.mrc.trainers.mrc.MRCTrainer.get_optimizer_cls_and_kwargs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_optimizer_cls_and_kwargs</span></code></a></p></td>
<td><p>Returns the optimizer class and optimizer parameters based on the training arguments.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#primeqa.mrc.trainers.mrc.MRCTrainer.get_test_dataloader" title="primeqa.mrc.trainers.mrc.MRCTrainer.get_test_dataloader"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_test_dataloader</span></code></a></p></td>
<td><p>Returns the test [<cite>~torch.utils.data.DataLoader</cite>].</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#primeqa.mrc.trainers.mrc.MRCTrainer.get_train_dataloader" title="primeqa.mrc.trainers.mrc.MRCTrainer.get_train_dataloader"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_train_dataloader</span></code></a></p></td>
<td><p>Returns the training torch <cite>DataLoader</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#primeqa.mrc.trainers.mrc.MRCTrainer.hyperparameter_search" title="primeqa.mrc.trainers.mrc.MRCTrainer.hyperparameter_search"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hyperparameter_search</span></code></a></p></td>
<td><p>Launch an hyperparameter search using <cite>optuna</cite> or <cite>Ray Tune</cite> or <cite>SigOpt</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#primeqa.mrc.trainers.mrc.MRCTrainer.init_git_repo" title="primeqa.mrc.trainers.mrc.MRCTrainer.init_git_repo"><code class="xref py py-obj docutils literal notranslate"><span class="pre">init_git_repo</span></code></a></p></td>
<td><p>Initializes a git repo in <cite>self.args.hub_model_id</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#primeqa.mrc.trainers.mrc.MRCTrainer.is_local_process_zero" title="primeqa.mrc.trainers.mrc.MRCTrainer.is_local_process_zero"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_local_process_zero</span></code></a></p></td>
<td><p>Whether or not this process is the local (e.g., on one machine if training in a distributed fashion on several machines) main process.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#primeqa.mrc.trainers.mrc.MRCTrainer.is_world_process_zero" title="primeqa.mrc.trainers.mrc.MRCTrainer.is_world_process_zero"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_world_process_zero</span></code></a></p></td>
<td><p>Whether or not this process is the global main process (when training in a distributed fashion on several machines, this is only going to be <cite>True</cite> for one process).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#primeqa.mrc.trainers.mrc.MRCTrainer.log" title="primeqa.mrc.trainers.mrc.MRCTrainer.log"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log</span></code></a></p></td>
<td><p>Log <cite>logs</cite> on the various objects watching training.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#primeqa.mrc.trainers.mrc.MRCTrainer.log_metrics" title="primeqa.mrc.trainers.mrc.MRCTrainer.log_metrics"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_metrics</span></code></a></p></td>
<td><p>Log metrics in a specially formatted way</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#primeqa.mrc.trainers.mrc.MRCTrainer.metrics_format" title="primeqa.mrc.trainers.mrc.MRCTrainer.metrics_format"><code class="xref py py-obj docutils literal notranslate"><span class="pre">metrics_format</span></code></a></p></td>
<td><p>Reformat Trainer metrics values to a human-readable format</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#primeqa.mrc.trainers.mrc.MRCTrainer.num_examples" title="primeqa.mrc.trainers.mrc.MRCTrainer.num_examples"><code class="xref py py-obj docutils literal notranslate"><span class="pre">num_examples</span></code></a></p></td>
<td><p>Helper to get number of samples in a [<cite>~torch.utils.data.DataLoader</cite>] by accessing its dataset.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#primeqa.mrc.trainers.mrc.MRCTrainer.pop_callback" title="primeqa.mrc.trainers.mrc.MRCTrainer.pop_callback"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pop_callback</span></code></a></p></td>
<td><p>Remove a callback from the current list of [<cite>~transformer.TrainerCallback</cite>] and returns it.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#primeqa.mrc.trainers.mrc.MRCTrainer.predict" title="primeqa.mrc.trainers.mrc.MRCTrainer.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a></p></td>
<td><p>Obtain the predictions using either eval data passed to method (if given).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#primeqa.mrc.trainers.mrc.MRCTrainer.prediction_loop" title="primeqa.mrc.trainers.mrc.MRCTrainer.prediction_loop"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prediction_loop</span></code></a></p></td>
<td><p>Prediction/evaluation loop, shared by <cite>Trainer.evaluate()</cite> and <cite>Trainer.predict()</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#primeqa.mrc.trainers.mrc.MRCTrainer.prediction_step" title="primeqa.mrc.trainers.mrc.MRCTrainer.prediction_step"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prediction_step</span></code></a></p></td>
<td><p>Perform an evaluation step on <cite>model</cite> using <cite>inputs</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#primeqa.mrc.trainers.mrc.MRCTrainer.push_to_hub" title="primeqa.mrc.trainers.mrc.MRCTrainer.push_to_hub"><code class="xref py py-obj docutils literal notranslate"><span class="pre">push_to_hub</span></code></a></p></td>
<td><p>Upload <em>self.model</em> and <em>self.tokenizer</em> to the  model hub on the repo <em>self.args.hub_model_id</em>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#primeqa.mrc.trainers.mrc.MRCTrainer.remove_callback" title="primeqa.mrc.trainers.mrc.MRCTrainer.remove_callback"><code class="xref py py-obj docutils literal notranslate"><span class="pre">remove_callback</span></code></a></p></td>
<td><p>Remove a callback from the current list of [<cite>~transformer.TrainerCallback</cite>].</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#primeqa.mrc.trainers.mrc.MRCTrainer.save_metrics" title="primeqa.mrc.trainers.mrc.MRCTrainer.save_metrics"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_metrics</span></code></a></p></td>
<td><p>Save metrics into a json file for that split, e.g.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#primeqa.mrc.trainers.mrc.MRCTrainer.save_model" title="primeqa.mrc.trainers.mrc.MRCTrainer.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a></p></td>
<td><p>Will save the model, so you can reload it using <cite>from_pretrained()</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#primeqa.mrc.trainers.mrc.MRCTrainer.save_state" title="primeqa.mrc.trainers.mrc.MRCTrainer.save_state"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_state</span></code></a></p></td>
<td><p>Saves the Trainer state, since Trainer.save_model saves only the tokenizer with the model</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">store_flos</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#primeqa.mrc.trainers.mrc.MRCTrainer.train" title="primeqa.mrc.trainers.mrc.MRCTrainer.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a></p></td>
<td><p>Main training entry point.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#primeqa.mrc.trainers.mrc.MRCTrainer.training_step" title="primeqa.mrc.trainers.mrc.MRCTrainer.training_step"><code class="xref py py-obj docutils literal notranslate"><span class="pre">training_step</span></code></a></p></td>
<td><p>Perform a training step on a batch of inputs.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="primeqa.mrc.trainers.mrc.MRCTrainer.add_callback">
<span class="sig-name descname"><span class="pre">add_callback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">callback</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#primeqa.mrc.trainers.mrc.MRCTrainer.add_callback" title="Permalink to this definition">#</a></dt>
<dd><p>Add a callback to the current list of [<cite>~transformer.TrainerCallback</cite>].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>callback</strong> (<cite>type</cite> or [<cite>~transformer.TrainerCallback</cite>])  A [<cite>~transformer.TrainerCallback</cite>] class or an instance of a [<cite>~transformer.TrainerCallback</cite>]. In the
first case, will instantiate a member of that class.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="primeqa.mrc.trainers.mrc.MRCTrainer.autocast_smart_context_manager">
<span class="sig-name descname"><span class="pre">autocast_smart_context_manager</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#primeqa.mrc.trainers.mrc.MRCTrainer.autocast_smart_context_manager" title="Permalink to this definition">#</a></dt>
<dd><p>A helper wrapper that creates an appropriate context manager for <cite>autocast</cite> while feeding it the desired
arguments, depending on the situation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="primeqa.mrc.trainers.mrc.MRCTrainer.compute_loss">
<span class="sig-name descname"><span class="pre">compute_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#primeqa.mrc.trainers.mrc.MRCTrainer.compute_loss" title="Permalink to this definition">#</a></dt>
<dd><p>How the loss is computed by Trainer. By default, all models return the loss in the first element.</p>
<p>Subclass and override for custom behavior.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="primeqa.mrc.trainers.mrc.MRCTrainer.create_optimizer">
<span class="sig-name descname"><span class="pre">create_optimizer</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#primeqa.mrc.trainers.mrc.MRCTrainer.create_optimizer" title="Permalink to this definition">#</a></dt>
<dd><p>Setup the optimizer.</p>
<p>We provide a reasonable default that works well. If you want to use something else, you can pass a tuple in the
Trainers init through <cite>optimizers</cite>, or subclass and override this method in a subclass.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="primeqa.mrc.trainers.mrc.MRCTrainer.create_optimizer_and_scheduler">
<span class="sig-name descname"><span class="pre">create_optimizer_and_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_training_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#primeqa.mrc.trainers.mrc.MRCTrainer.create_optimizer_and_scheduler" title="Permalink to this definition">#</a></dt>
<dd><p>Setup the optimizer and the learning rate scheduler.</p>
<p>We provide a reasonable default that works well. If you want to use something else, you can pass a tuple in the
Trainers init through <cite>optimizers</cite>, or subclass and override this method (or <cite>create_optimizer</cite> and/or
<cite>create_scheduler</cite>) in a subclass.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="primeqa.mrc.trainers.mrc.MRCTrainer.create_scheduler">
<span class="sig-name descname"><span class="pre">create_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_training_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.optim.optimizer.Optimizer</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#primeqa.mrc.trainers.mrc.MRCTrainer.create_scheduler" title="Permalink to this definition">#</a></dt>
<dd><p>Setup the scheduler. The optimizer of the trainer must have been set up either before this method is called or
passed as an argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>num_training_steps</strong> (<em>int</em>)  The number of training steps to do.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="primeqa.mrc.trainers.mrc.MRCTrainer.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eval_dataset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_examples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_key_prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'eval'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#primeqa.mrc.trainers.mrc.MRCTrainer.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate model using either eval data passed to method (if given).
Otherwise use data given to constructor at instantiation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eval_examples</strong>  Eval examples <cite>Dataset</cite> from <cite>BasePreprocessor.process_eval</cite>.</p></li>
<li><p><strong>eval_dataset</strong>  Eval features <cite>Dataset</cite> from <cite>BasePreprocessor.process_eval</cite>.</p></li>
<li><p><strong>ignore_keys</strong>  Keys to ignore in evaluation loop.</p></li>
<li><p><strong>metric_key_prefix</strong>  Append this prefix to metric names.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Evaluation metrics if post-processing and metric computation functions
were provided to constructor at instantiation, otherwise an empty dict.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="primeqa.mrc.trainers.mrc.MRCTrainer.evaluation_loop">
<span class="sig-name descname"><span class="pre">evaluation_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataloader</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.utils.data.dataloader.DataLoader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">description</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_loss_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_key_prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'eval'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">transformers.trainer_utils.EvalLoopOutput</span></span></span><a class="headerlink" href="#primeqa.mrc.trainers.mrc.MRCTrainer.evaluation_loop" title="Permalink to this definition">#</a></dt>
<dd><p>Prediction/evaluation loop, shared by <cite>Trainer.evaluate()</cite> and <cite>Trainer.predict()</cite>.</p>
<p>Works both with or without labels.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="primeqa.mrc.trainers.mrc.MRCTrainer.floating_point_ops">
<span class="sig-name descname"><span class="pre">floating_point_ops</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#primeqa.mrc.trainers.mrc.MRCTrainer.floating_point_ops" title="Permalink to this definition">#</a></dt>
<dd><p>For models that inherit from [<cite>PreTrainedModel</cite>], uses that method to compute the number of floating point
operations for every backward + forward pass. If using another model, either implement such a method in the
model or subclass and override this method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>inputs</strong> (<cite>Dict[str, Union[torch.Tensor, Any]]</cite>)  The inputs and targets of the model.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The number of floating-point operations.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>int</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="primeqa.mrc.trainers.mrc.MRCTrainer.get_eval_dataloader">
<span class="sig-name descname"><span class="pre">get_eval_dataloader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eval_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">datasets.arrow_dataset.Dataset</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.utils.data.dataloader.DataLoader</span></span></span><a class="headerlink" href="#primeqa.mrc.trainers.mrc.MRCTrainer.get_eval_dataloader" title="Permalink to this definition">#</a></dt>
<dd><p>Returns the evaluation torch <cite>DataLoader</cite>.</p>
<p>Subclass and override this method if you want to inject some custom behavior.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>eval_dataset</strong>  If provided, will override <cite>self.eval_dataset</cite>. If it is an <cite>datasets.Dataset</cite>, columns not
accepted by the <cite>model.forward()</cite> method are automatically removed.
It must implement <cite>__len__</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="primeqa.mrc.trainers.mrc.MRCTrainer.get_optimizer_cls_and_kwargs">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_optimizer_cls_and_kwargs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">transformers.training_args.TrainingArguments</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#primeqa.mrc.trainers.mrc.MRCTrainer.get_optimizer_cls_and_kwargs" title="Permalink to this definition">#</a></dt>
<dd><p>Returns the optimizer class and optimizer parameters based on the training arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>args</strong> (<cite>transformers.training_args.TrainingArguments</cite>)  The training arguments for the training session.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="primeqa.mrc.trainers.mrc.MRCTrainer.get_test_dataloader">
<span class="sig-name descname"><span class="pre">get_test_dataloader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.utils.data.dataset.Dataset</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.utils.data.dataloader.DataLoader</span></span></span><a class="headerlink" href="#primeqa.mrc.trainers.mrc.MRCTrainer.get_test_dataloader" title="Permalink to this definition">#</a></dt>
<dd><p>Returns the test [<cite>~torch.utils.data.DataLoader</cite>].</p>
<p>Subclass and override this method if you want to inject some custom behavior.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>test_dataset</strong> (<cite>torch.utils.data.Dataset</cite>, <em>optional</em>)  The test dataset to use. If it is an <cite>datasets.Dataset</cite>, columns not accepted by the <cite>model.forward()</cite>
method are automatically removed. It must implement <cite>__len__</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="primeqa.mrc.trainers.mrc.MRCTrainer.get_train_dataloader">
<span class="sig-name descname"><span class="pre">get_train_dataloader</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.utils.data.dataloader.DataLoader</span></span></span><a class="headerlink" href="#primeqa.mrc.trainers.mrc.MRCTrainer.get_train_dataloader" title="Permalink to this definition">#</a></dt>
<dd><p>Returns the training torch <cite>DataLoader</cite>.</p>
<p>Will use no sampler if <cite>self.train_dataset</cite> does not implement <cite>__len__</cite>, a random sampler (adapted
to distributed training if necessary) otherwise.</p>
<p>Subclass and override this method if you want to inject some custom behavior.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="primeqa.mrc.trainers.mrc.MRCTrainer.hyperparameter_search">
<span class="sig-name descname"><span class="pre">hyperparameter_search</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hp_space</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">optuna.Trial</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_objective</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_trials</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'minimize'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backend</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">transformers.trainer_utils.HPSearchBackend</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">optuna.Trial</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">transformers.trainer_utils.BestRun</span></span></span><a class="headerlink" href="#primeqa.mrc.trainers.mrc.MRCTrainer.hyperparameter_search" title="Permalink to this definition">#</a></dt>
<dd><p>Launch an hyperparameter search using <cite>optuna</cite> or <cite>Ray Tune</cite> or <cite>SigOpt</cite>. The optimized quantity is determined
by <cite>compute_objective</cite>, which defaults to a function returning the evaluation loss when no metric is provided,
the sum of all metrics otherwise.</p>
<p>&lt;Tip warning={true}&gt;</p>
<p>To use this method, you need to have provided a <cite>model_init</cite> when initializing your [<cite>Trainer</cite>]: we need to
reinitialize the model at each new run. This is incompatible with the <cite>optimizers</cite> argument, so you need to
subclass [<cite>Trainer</cite>] and override the method [<cite>~Trainer.create_optimizer_and_scheduler</cite>] for custom
optimizer/scheduler.</p>
<p>&lt;/Tip&gt;</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hp_space</strong> (<cite>Callable[[optuna.Trial], Dict[str, float]]</cite>, <em>optional</em>)  A function that defines the hyperparameter search space. Will default to
[<cite>~trainer_utils.default_hp_space_optuna</cite>] or [<cite>~trainer_utils.default_hp_space_ray</cite>] or
[<cite>~trainer_utils.default_hp_space_sigopt</cite>] depending on your backend.</p></li>
<li><p><strong>compute_objective</strong> (<cite>Callable[[Dict[str, float]], float]</cite>, <em>optional</em>)  A function computing the objective to minimize or maximize from the metrics returned by the <cite>evaluate</cite>
method. Will default to [<cite>~trainer_utils.default_compute_objective</cite>].</p></li>
<li><p><strong>n_trials</strong> (<cite>int</cite>, <em>optional</em>, defaults to 100)  The number of trial runs to test.</p></li>
<li><p><strong>direction</strong> (<cite>str</cite>, <em>optional</em>, defaults to <cite>minimize</cite>)  Whether to optimize greater or lower objects. Can be <cite>minimize</cite> or <cite>maximize</cite>, you should pick
<cite>minimize</cite> when optimizing the validation loss, <cite>maximize</cite> when optimizing one or several metrics.</p></li>
<li><p><strong>backend</strong> (<cite>str</cite> or [<cite>~training_utils.HPSearchBackend</cite>], <em>optional</em>)  The backend to use for hyperparameter search. Will default to optuna or Ray Tune or SigOpt, depending
on which one is installed. If all are installed, will default to optuna.</p></li>
<li><p><strong>kwargs</strong>  <p>Additional keyword arguments passed along to <cite>optuna.create_study</cite> or <cite>ray.tune.run</cite>. For more
information see:</p>
<ul>
<li><p>the documentation of
[optuna.create_study](<a class="reference external" href="https://optuna.readthedocs.io/en/stable/reference/generated/optuna.study.create_study.html">https://optuna.readthedocs.io/en/stable/reference/generated/optuna.study.create_study.html</a>)</p></li>
<li><p>the documentation of [tune.run](<a class="reference external" href="https://docs.ray.io/en/latest/tune/api_docs/execution.html#tune-run">https://docs.ray.io/en/latest/tune/api_docs/execution.html#tune-run</a>)</p></li>
<li><p>the documentation of [sigopt](<a class="reference external" href="https://app.sigopt.com/docs/endpoints/experiments/create">https://app.sigopt.com/docs/endpoints/experiments/create</a>)</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>All the information about the best run.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>[<cite>trainer_utils.BestRun</cite>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="primeqa.mrc.trainers.mrc.MRCTrainer.init_git_repo">
<span class="sig-name descname"><span class="pre">init_git_repo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">at_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#primeqa.mrc.trainers.mrc.MRCTrainer.init_git_repo" title="Permalink to this definition">#</a></dt>
<dd><p>Initializes a git repo in <cite>self.args.hub_model_id</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>at_init</strong> (<cite>bool</cite>, <em>optional</em>, defaults to <cite>False</cite>)  Whether this function is called before any training or not. If <cite>self.args.overwrite_output_dir</cite> is
<cite>True</cite> and <cite>at_init</cite> is <cite>True</cite>, the path to the repo (which is <cite>self.args.output_dir</cite>) might be wiped
out.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="primeqa.mrc.trainers.mrc.MRCTrainer.is_local_process_zero">
<span class="sig-name descname"><span class="pre">is_local_process_zero</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#primeqa.mrc.trainers.mrc.MRCTrainer.is_local_process_zero" title="Permalink to this definition">#</a></dt>
<dd><p>Whether or not this process is the local (e.g., on one machine if training in a distributed fashion on several
machines) main process.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="primeqa.mrc.trainers.mrc.MRCTrainer.is_world_process_zero">
<span class="sig-name descname"><span class="pre">is_world_process_zero</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#primeqa.mrc.trainers.mrc.MRCTrainer.is_world_process_zero" title="Permalink to this definition">#</a></dt>
<dd><p>Whether or not this process is the global main process (when training in a distributed fashion on several
machines, this is only going to be <cite>True</cite> for one process).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="primeqa.mrc.trainers.mrc.MRCTrainer.log">
<span class="sig-name descname"><span class="pre">log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#primeqa.mrc.trainers.mrc.MRCTrainer.log" title="Permalink to this definition">#</a></dt>
<dd><p>Log <cite>logs</cite> on the various objects watching training.</p>
<p>Subclass and override this method to inject custom behavior.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>logs</strong> (<cite>Dict[str, float]</cite>)  The values to log.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="primeqa.mrc.trainers.mrc.MRCTrainer.log_metrics">
<span class="sig-name descname"><span class="pre">log_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">split</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#primeqa.mrc.trainers.mrc.MRCTrainer.log_metrics" title="Permalink to this definition">#</a></dt>
<dd><p>Log metrics in a specially formatted way</p>
<p>Under distributed environment this is done only for a process with rank 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>split</strong> (<cite>str</cite>)  Mode/split name: one of <cite>train</cite>, <cite>eval</cite>, <cite>test</cite></p></li>
<li><p><strong>metrics</strong> (<cite>Dict[str, float]</cite>)  The metrics returned from train/evaluate/predictmetrics: metrics dict</p></li>
</ul>
</dd>
</dl>
<p>Notes on memory reports:</p>
<p>In order to get memory usage report you need to install <cite>psutil</cite>. You can do that with <cite>pip install psutil</cite>.</p>
<p>Now when this method is run, you will see a report that will include: :</p>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">init_mem_cpu_alloc_delta</span>&#160;&#160; <span class="pre">=</span>&#160;&#160;&#160;&#160; <span class="pre">1301MB</span>
<span class="pre">init_mem_cpu_peaked_delta</span>&#160; <span class="pre">=</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">154MB</span>
<span class="pre">init_mem_gpu_alloc_delta</span>&#160;&#160; <span class="pre">=</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">230MB</span>
<span class="pre">init_mem_gpu_peaked_delta</span>&#160; <span class="pre">=</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">0MB</span>
<span class="pre">train_mem_cpu_alloc_delta</span>&#160; <span class="pre">=</span>&#160;&#160;&#160;&#160; <span class="pre">1345MB</span>
<span class="pre">train_mem_cpu_peaked_delta</span> <span class="pre">=</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">0MB</span>
<span class="pre">train_mem_gpu_alloc_delta</span>&#160; <span class="pre">=</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">693MB</span>
<span class="pre">train_mem_gpu_peaked_delta</span> <span class="pre">=</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">7MB</span>
<span class="pre">`</span></code></p>
<p><strong>Understanding the reports:</strong></p>
<ul class="simple">
<li><dl class="simple">
<dt>the first segment, e.g., <cite>train__</cite>, tells you which stage the metrics are for. Reports starting with <cite>init_</cite></dt><dd><p>will be added to the first stage that gets run. So that if only evaluation is run, the memory usage for the
<cite>__init__</cite> will be reported along with the <cite>eval_</cite> metrics.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>the third segment, is either <cite>cpu</cite> or <cite>gpu</cite>, tells you whether its the general RAM or the gpu0 memory</dt><dd><p>metric.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>*_alloc_delta</cite> - is the difference in the used/allocated memory counter between the end and the start of the</dt><dd><p>stage - it can be negative if a function released more memory than it allocated.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>*_peaked_delta</cite> - is any extra memory that was consumed and then freed - relative to the current allocated</dt><dd><p>memory counter - it is never negative. When you look at the metrics of any stage you add up <cite>alloc_delta</cite> +
<cite>peaked_delta</cite> and you know how much memory was needed to complete that stage.</p>
</dd>
</dl>
</li>
</ul>
<p>The reporting happens only for process of rank 0 and gpu 0 (if there is a gpu). Typically this is enough since the
main process does the bulk of work, but it could be not quite so if model parallel is used and then other GPUs may
use a different amount of gpu memory. This is also not the same under DataParallel where gpu0 may require much more
memory than the rest since it stores the gradient and optimizer states for all participating GPUS. Perhaps in the
future these reports will evolve to measure those too.</p>
<p>The CPU RAM metric measures RSS (Resident Set Size) includes both the memory which is unique to the process and the
memory shared with other processes. It is important to note that it does not include swapped out memory, so the
reports could be imprecise.</p>
<p>The CPU peak memory is measured using a sampling thread. Due to pythons GIL it may miss some of the peak memory if
that thread didnt get a chance to run when the highest memory was used. Therefore this report can be less than
reality. Using <cite>tracemalloc</cite> would have reported the exact peak memory, but it doesnt report memory allocations
outside of python. So if some C++ CUDA extension allocated its own memory it wont be reported. And therefore it
was dropped in favor of the memory sampling approach, which reads the current process memory usage.</p>
<p>The GPU allocated and peak memory reporting is done with <cite>torch.cuda.memory_allocated()</cite> and
<cite>torch.cuda.max_memory_allocated()</cite>. This metric reports only deltas for pytorch-specific allocations, as
<cite>torch.cuda</cite> memory management system doesnt track any memory allocated outside of pytorch. For example, the very
first cuda call typically loads CUDA kernels, which may take from 0.5 to 2GB of GPU memory.</p>
<p>Note that this tracker doesnt account for memory allocations outside of [<cite>Trainer</cite>]s <cite>__init__</cite>, <cite>train</cite>,
<cite>evaluate</cite> and <cite>predict</cite> calls.</p>
<p>Because <cite>evaluation</cite> calls may happen during <cite>train</cite>, we cant handle nested invocations because
<cite>torch.cuda.max_memory_allocated</cite> is a single counter, so if it gets reset by a nested eval call, <cite>train</cite>s tracker
will report incorrect info. If this [pytorch issue](<a class="reference external" href="https://github.com/pytorch/pytorch/issues/16266">https://github.com/pytorch/pytorch/issues/16266</a>) gets resolved
it will be possible to change this class to be re-entrant. Until then we will only track the outer level of
<cite>train</cite>, <cite>evaluate</cite> and <cite>predict</cite> methods. Which means that if <cite>eval</cite> is called during <cite>train</cite>, its the latter
that will account for its memory usage and that of the former.</p>
<p>This also means that if any other tool that is used along the [<cite>Trainer</cite>] calls
<cite>torch.cuda.reset_peak_memory_stats</cite>, the gpu peak memory stats could be invalid. And the [<cite>Trainer</cite>] will disrupt
the normal behavior of any such tools that rely on calling <cite>torch.cuda.reset_peak_memory_stats</cite> themselves.</p>
<p>For best performance you may want to consider turning the memory profiling off for production runs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="primeqa.mrc.trainers.mrc.MRCTrainer.metrics_format">
<span class="sig-name descname"><span class="pre">metrics_format</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#primeqa.mrc.trainers.mrc.MRCTrainer.metrics_format" title="Permalink to this definition">#</a></dt>
<dd><p>Reformat Trainer metrics values to a human-readable format</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>metrics</strong> (<cite>Dict[str, float]</cite>)  The metrics returned from train/evaluate/predict</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The reformatted metrics</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>metrics (<cite>Dict[str, float]</cite>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="primeqa.mrc.trainers.mrc.MRCTrainer.num_examples">
<span class="sig-name descname"><span class="pre">num_examples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataloader</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.utils.data.dataloader.DataLoader</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#primeqa.mrc.trainers.mrc.MRCTrainer.num_examples" title="Permalink to this definition">#</a></dt>
<dd><p>Helper to get number of samples in a [<cite>~torch.utils.data.DataLoader</cite>] by accessing its dataset.</p>
<p>Will raise an exception if the underlying dataset does not implement method <cite>__len__</cite></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="primeqa.mrc.trainers.mrc.MRCTrainer.pop_callback">
<span class="sig-name descname"><span class="pre">pop_callback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">callback</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#primeqa.mrc.trainers.mrc.MRCTrainer.pop_callback" title="Permalink to this definition">#</a></dt>
<dd><p>Remove a callback from the current list of [<cite>~transformer.TrainerCallback</cite>] and returns it.</p>
<p>If the callback is not found, returns <cite>None</cite> (and no error is raised).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>callback</strong> (<cite>type</cite> or [<cite>~transformer.TrainerCallback</cite>])  A [<cite>~transformer.TrainerCallback</cite>] class or an instance of a [<cite>~transformer.TrainerCallback</cite>]. In the
first case, will pop the first member of that class found in the list of callbacks.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The callback removed, if found.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>[<cite>~transformer.TrainerCallback</cite>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="primeqa.mrc.trainers.mrc.MRCTrainer.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eval_dataset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_examples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#primeqa.mrc.trainers.mrc.MRCTrainer.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Obtain the predictions using either eval data passed to method (if given).
Otherwise use data given to constructor at instantiation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eval_examples</strong>  Eval examples <cite>Dataset</cite> from <cite>BasePreprocessor.process_eval</cite>.</p></li>
<li><p><strong>eval_dataset</strong>  Eval features <cite>Dataset</cite> from <cite>BasePreprocessor.process_eval</cite>.</p></li>
<li><p><strong>ignore_keys</strong>  Keys to ignore in evaluation loop.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Answer predictions if post-processing function was provided to constructor
at instantiation, otherwise an empty dict.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="primeqa.mrc.trainers.mrc.MRCTrainer.prediction_loop">
<span class="sig-name descname"><span class="pre">prediction_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataloader</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.utils.data.dataloader.DataLoader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">description</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_loss_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_key_prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'eval'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">transformers.trainer_utils.PredictionOutput</span></span></span><a class="headerlink" href="#primeqa.mrc.trainers.mrc.MRCTrainer.prediction_loop" title="Permalink to this definition">#</a></dt>
<dd><p>Prediction/evaluation loop, shared by <cite>Trainer.evaluate()</cite> and <cite>Trainer.predict()</cite>.</p>
<p>Works both with or without labels.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="primeqa.mrc.trainers.mrc.MRCTrainer.prediction_step">
<span class="sig-name descname"><span class="pre">prediction_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.nn.modules.module.Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_loss_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#primeqa.mrc.trainers.mrc.MRCTrainer.prediction_step" title="Permalink to this definition">#</a></dt>
<dd><p>Perform an evaluation step on <cite>model</cite> using <cite>inputs</cite>.</p>
<p>Subclass and override to inject custom behavior.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<cite>nn.Module</cite>)  The model to evaluate.</p></li>
<li><p><strong>inputs</strong> (<cite>Dict[str, Union[torch.Tensor, Any]]</cite>)  <p>The inputs and targets of the model.</p>
<p>The dictionary will be unpacked before being fed to the model. Most models expect the targets under the
argument <cite>labels</cite>. Check your models documentation for all accepted arguments.</p>
</p></li>
<li><p><strong>prediction_loss_only</strong> (<cite>bool</cite>)  Whether or not to return the loss only.</p></li>
<li><p><strong>ignore_keys</strong> (<cite>Lst[str]</cite>, <em>optional</em>)  A list of keys in the output of your model (if it is a dictionary) that should be ignored when
gathering predictions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple with the loss,
logits and labels (each being optional).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple[Optional[torch.Tensor], Optional[torch.Tensor], Optional[torch.Tensor]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="primeqa.mrc.trainers.mrc.MRCTrainer.push_to_hub">
<span class="sig-name descname"><span class="pre">push_to_hub</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">commit_message</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'End</span> <span class="pre">of</span> <span class="pre">training'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blocking</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#primeqa.mrc.trainers.mrc.MRCTrainer.push_to_hub" title="Permalink to this definition">#</a></dt>
<dd><p>Upload <em>self.model</em> and <em>self.tokenizer</em> to the  model hub on the repo <em>self.args.hub_model_id</em>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>commit_message</strong> (<cite>str</cite>, <em>optional</em>, defaults to <cite>End of training</cite>)  Message to commit while pushing.</p></li>
<li><p><strong>blocking</strong> (<cite>bool</cite>, <em>optional</em>, defaults to <cite>True</cite>)  Whether the function should return only when the <cite>git push</cite> has finished.</p></li>
<li><p><strong>kwargs</strong>  Additional keyword arguments passed along to [<cite>~Trainer.create_model_card</cite>].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The url of the commit of your model in the given repository if <cite>blocking=False</cite>, a tuple with the url of
the commit and an object to track the progress of the commit if <cite>blocking=True</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="primeqa.mrc.trainers.mrc.MRCTrainer.remove_callback">
<span class="sig-name descname"><span class="pre">remove_callback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">callback</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#primeqa.mrc.trainers.mrc.MRCTrainer.remove_callback" title="Permalink to this definition">#</a></dt>
<dd><p>Remove a callback from the current list of [<cite>~transformer.TrainerCallback</cite>].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>callback</strong> (<cite>type</cite> or [<cite>~transformer.TrainerCallback</cite>])  A [<cite>~transformer.TrainerCallback</cite>] class or an instance of a [<cite>~transformer.TrainerCallback</cite>]. In the
first case, will remove the first member of that class found in the list of callbacks.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="primeqa.mrc.trainers.mrc.MRCTrainer.save_metrics">
<span class="sig-name descname"><span class="pre">save_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">split</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">combined</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#primeqa.mrc.trainers.mrc.MRCTrainer.save_metrics" title="Permalink to this definition">#</a></dt>
<dd><p>Save metrics into a json file for that split, e.g. <cite>train_results.json</cite>.</p>
<p>Under distributed environment this is done only for a process with rank 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>split</strong> (<cite>str</cite>)  Mode/split name: one of <cite>train</cite>, <cite>eval</cite>, <cite>test</cite>, <cite>all</cite></p></li>
<li><p><strong>metrics</strong> (<cite>Dict[str, float]</cite>)  The metrics returned from train/evaluate/predict</p></li>
<li><p><strong>combined</strong> (<cite>bool</cite>, <em>optional</em>, defaults to <cite>True</cite>)  Creates combined metrics by updating <cite>all_results.json</cite> with metrics of this call</p></li>
</ul>
</dd>
</dl>
<p>To understand the metrics please read the docstring of [<cite>~Trainer.log_metrics</cite>]. The only difference is that raw
unformatted numbers are saved in the current method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="primeqa.mrc.trainers.mrc.MRCTrainer.save_model">
<span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_internal_call</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#primeqa.mrc.trainers.mrc.MRCTrainer.save_model" title="Permalink to this definition">#</a></dt>
<dd><p>Will save the model, so you can reload it using <cite>from_pretrained()</cite>.</p>
<p>Will only save from the main process.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="primeqa.mrc.trainers.mrc.MRCTrainer.save_state">
<span class="sig-name descname"><span class="pre">save_state</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#primeqa.mrc.trainers.mrc.MRCTrainer.save_state" title="Permalink to this definition">#</a></dt>
<dd><p>Saves the Trainer state, since Trainer.save_model saves only the tokenizer with the model</p>
<p>Under distributed environment this is done only for a process with rank 0.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="primeqa.mrc.trainers.mrc.MRCTrainer.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resume_from_checkpoint</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trial</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">optuna.Trial</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_keys_for_eval</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#primeqa.mrc.trainers.mrc.MRCTrainer.train" title="Permalink to this definition">#</a></dt>
<dd><p>Main training entry point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>resume_from_checkpoint</strong> (<cite>str</cite> or <cite>bool</cite>, <em>optional</em>)  If a <cite>str</cite>, local path to a saved checkpoint as saved by a previous instance of [<cite>Trainer</cite>]. If a
<cite>bool</cite> and equals <cite>True</cite>, load the last checkpoint in <em>args.output_dir</em> as saved by a previous instance
of [<cite>Trainer</cite>]. If present, training will resume from the model/optimizer/scheduler states loaded here.</p></li>
<li><p><strong>trial</strong> (<cite>optuna.Trial</cite> or <cite>Dict[str, Any]</cite>, <em>optional</em>)  The trial run or the hyperparameter dictionary for hyperparameter search.</p></li>
<li><p><strong>ignore_keys_for_eval</strong> (<cite>List[str]</cite>, <em>optional</em>)  A list of keys in the output of your model (if it is a dictionary) that should be ignored when
gathering predictions for evaluation during the training.</p></li>
<li><p><strong>kwargs</strong>  Additional keyword arguments used to hide deprecated arguments</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="primeqa.mrc.trainers.mrc.MRCTrainer.training_step">
<span class="sig-name descname"><span class="pre">training_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.nn.modules.module.Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="headerlink" href="#primeqa.mrc.trainers.mrc.MRCTrainer.training_step" title="Permalink to this definition">#</a></dt>
<dd><p>Perform a training step on a batch of inputs.</p>
<p>Subclass and override to inject custom behavior.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<cite>nn.Module</cite>)  The model to train.</p></li>
<li><p><strong>inputs</strong> (<cite>Dict[str, Union[torch.Tensor, Any]]</cite>)  <p>The inputs and targets of the model.</p>
<p>The dictionary will be unpacked before being fed to the model. Most models expect the targets under the
argument <cite>labels</cite>. Check your models documentation for all accepted arguments.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The tensor with training loss on this batch.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>torch.Tensor</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


              </article>
              

              
              <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
              </footer>
              
          </div>
          
      </div>
    </div>

  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695"></script>

<footer class="bd-footer"><div class="bd-footer__inner container">
  
</div>
</footer>
  </body>
</html>